<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Content Manager</title>

  <!-- Link to the stable preview CSS file in the public directory -->
  <link rel="stylesheet" href="/admin-preview.css">

  <!-- Optional: Add specific CSS overrides for the admin UI itself -->
  <style>
    /* Example: body { font-family: sans-serif; } */
  </style>

</head>
<body>
  <!-- Decap CMS Core Script -->
  <script src="https://unpkg.com/decap-cms@^3.1.0/dist/decap-cms.js"></script>

  <!-- Custom Preview Registration Script -->
  <script type="module">
    // This script runs in the browser within the /admin/ page

    // Get reference to the CMS object (`CMS` is usually global)
    const CMS = window.CMS;

    // Import the Astro component for the preview
    // IMPORTANT: Adjust the path if your component is located differently
    // The path MUST start with '/' and be relative to the project root from the browser's perspective
    import FeedEntryPreview from '/src/cms-previews/FeedEntryPreview.astro';

    if (CMS && FeedEntryPreview) {
      // Register the preview component for the 'feed' collection
      CMS.registerPreviewTemplate('feed', FeedEntryPreview);
      console.log("Feed entry preview template registered successfully.");
    } else {
      console.error("CMS or FeedEntryPreview component not found. Preview registration failed.");
      if (!CMS) console.error("CMS object is missing.");
      if (!FeedEntryPreview) console.error("FeedEntryPreview component failed to import. Check path and component file.");
    }
  </script>
</body>
</html>