---
// src/layouts/BaseLayout.astro
interface Props {
    title?: string;
}
const { title = 'Portfolio' } = Astro.props;
---
<!doctype html>
<html lang="en" class="desktop-layout">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <title>{title}</title>

    <script is:inline>
      const THEME_KEY = 'theme-preference';
      const THEME_CLASS_LIGHT = 'light-mode';
      const THEME_CLASS_DARK = 'dark-mode'; // This variable isn't actively used to apply dark theme with current CSS

      const getThemePreference = () => {
        if (typeof localStorage !== 'undefined') {
          const storedTheme = localStorage.getItem(THEME_KEY);
          if (storedTheme) {
            return storedTheme;
          }
        }
        // Default to 'light' if no theme is stored in localStorage
        return 'light';
      };

      const applyTheme = (theme) => {
        document.documentElement.classList.remove(THEME_CLASS_LIGHT, THEME_CLASS_DARK);
        if (theme === 'light') {
          document.documentElement.classList.add(THEME_CLASS_LIGHT);
        } else {
          // Dark theme is applied by removing THEME_CLASS_LIGHT, 
          // as CSS defaults to dark theme styles.
        }
      };
      
      // Make currentTheme available globally on window for other scripts if needed
      window.currentTheme = getThemePreference();
      applyTheme(window.currentTheme);

      window.toggleTheme = () => {
        window.currentTheme = window.currentTheme === 'light' ? 'dark' : 'light';
        localStorage.setItem(THEME_KEY, window.currentTheme);
        applyTheme(window.currentTheme);
        document.dispatchEvent(new CustomEvent('themechanged', { detail: { theme: window.currentTheme } }));
      };
    </script>
      
    <style is:global>
        @import '../styles/global.css';

       :root {
          --desktop-identity-width: 31.8%;
          --desktop-divider-width: 2%;
          --desktop-main-header-width: 66.2%;
          --desktop-content-padding-top: var(--spacing-xl);
          --desktop-content-padding-bottom: var(--spacing-lg);
          --mobile-content-padding-x: var(--content-padding-x-mobile, var(--spacing-md));
          --mobile-header-height: 80px;
          --header-area-height: 90px; 
       }

        html { height: 100%; box-sizing: border-box; }
        *, *:before, *:after { box-sizing: inherit; }

        body {
            overscroll-behavior: none; min-height: 100%;
        }
        body.mobile-menu-open {
            overflow: hidden;
        }

        #app-container {
            box-sizing: border-box;
            position: relative;
        }
        #app-container > div:not(#mobile-header-sticky-container) { box-sizing: border-box; }
        #mobile-header-sticky-container { box-sizing: border-box; }


        @media (min-width: 769px) { /* DESKTOP */
            body { overflow: hidden; height: 100%; }
            #app-container { height: 100%; }
            #app-container.is-desktop {
                display: grid;
                grid-template-columns: var(--desktop-identity-width) var(--desktop-divider-width) var(--desktop-main-header-width);
                grid-template-rows: var(--header-area-height) 1fr;
                height: 100vh; overflow: hidden;
            }

            #app-container.is-desktop > #mobile-header-sticky-container {
                display: grid;
                grid-template-columns: var(--desktop-identity-width) var(--desktop-divider-width) var(--desktop-main-header-width);
                grid-column: 1 / 4; 
                grid-row: 1 / 2;    
                height: var(--header-area-height);
                background-color: var(--color-background);
                border-bottom: var(--line-thickness-subtle) solid var(--color-border-subtle);
                position: relative; 
                z-index: 20; 
            }

            #app-container.is-desktop > #mobile-header-sticky-container > #identity-header-area,
            #app-container.is-desktop > #mobile-header-sticky-container > #main-header-area {
                position: relative;
                overflow: hidden;
                font-size: 1.5em;
                height: 100%; 
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            #app-container.is-desktop > #mobile-header-sticky-container > #identity-header-area {
                 grid-column: 1 / 2; 
                 padding-left: var(--spacing-content-side-padding);
                 padding-right: var(--spacing-md);
                 pointer-events: none;
            }
            #app-container.is-desktop > #mobile-header-sticky-container > #identity-header-area > :global(a.identity-header-link-mobile-wrapper) {
                 pointer-events: auto; 
                 cursor: default;
            }
            #app-container.is-desktop > #mobile-header-sticky-container > #identity-header-area > :global(a.identity-header-link-mobile-wrapper > .identity-header-content-wrapper) {
                 pointer-events: auto; 
            }
            #app-container.is-desktop > #mobile-header-sticky-container > #main-header-area {
                 grid-column: 3 / 4; 
                 padding-right: var(--spacing-content-side-padding);
                 padding-left: var(--spacing-md);
            }

            #app-container.is-desktop > #divider-area {
                grid-column: 2 / 3; 
                grid-row: 1 / 3;    
                background: linear-gradient(to bottom, 
                    transparent 0, 
                    transparent var(--header-area-height), 
                    var(--color-background) var(--header-area-height), 
                    var(--color-background) 100%
                );
                z-index: 30; 
                position: relative; 
                display: block;
            }
            #app-container.is-desktop > #divider-area::before {
                 content: ''; 
                 position: absolute; 
                 top: 0; 
                 bottom: 0; 
                 left: 50%;
                 transform: translateX(-50%);
                 width: var(--line-thickness-subtle);
                 background-color: var(--color-border-subtle); 
                 opacity: 1;
            }

            #app-container.is-desktop > #info-content-area,
            #app-container.is-desktop > #dynamic-content-area,
            #app-container.is-desktop > #all-feed-content-area,
            #app-container.is-desktop > #overview-content-area,
            #app-container.is-desktop > #contact-content-area,
            #app-container.is-desktop > #feed-content-area {
                overflow-y: auto;
                scrollbar-width: thin;
                scrollbar-color: var(--scrollbar-thumb-color, #555) var(--scrollbar-track-color, #222);
            }
            #app-container.is-desktop > #info-content-area::-webkit-scrollbar,
            #app-container.is-desktop > #feed-content-area::-webkit-scrollbar,
            #app-container.is-desktop > #dynamic-content-area::-webkit-scrollbar,
            #app-container.is-desktop > #all-feed-content-area::-webkit-scrollbar,
            #app-container.is-desktop > #contact-content-area::-webkit-scrollbar,
            #app-container.is-desktop > #overview-content-area::-webkit-scrollbar { width: var(--scrollbar-width, 8px); }

            #app-container.is-desktop > #info-content-area::-webkit-scrollbar-track,
            #app-container.is-desktop > #feed-content-area::-webkit-scrollbar-track,
            #app-container.is-desktop > #dynamic-content-area::-webkit-scrollbar-track,
            #app-container.is-desktop > #all-feed-content-area::-webkit-scrollbar-track,
            #app-container.is-desktop > #contact-content-area::-webkit-scrollbar-track,
            #app-container.is-desktop > #overview-content-area::-webkit-scrollbar-track { background: var(--scrollbar-track-color, #222); }

            #app-container.is-desktop > #info-content-area::-webkit-scrollbar-thumb,
            #app-container.is-desktop > #feed-content-area::-webkit-scrollbar-thumb,
            #app-container.is-desktop > #dynamic-content-area::-webkit-scrollbar-thumb,
            #app-container.is-desktop > #all-feed-content-area::-webkit-scrollbar-thumb,
            #app-container.is-desktop > #contact-content-area::-webkit-scrollbar-thumb,
            #app-container.is-desktop > #overview-content-area::-webkit-scrollbar-thumb { background-color: var(--scrollbar-thumb-color, #555); border-radius: calc(var(--scrollbar-width, 8px) / 2); border: 2px solid var(--scrollbar-track-color, #222); }


            #app-container.is-desktop > #info-content-area {
                grid-column: 1 / 2; grid-row: 2 / 3; display: block;
                padding: var(--desktop-content-padding-top) var(--spacing-md) var(--desktop-content-padding-bottom) var(--spacing-content-side-padding);
            }
            #app-container.is-desktop > #dynamic-content-area,
            #app-container.is-desktop > #all-feed-content-area,
            #app-container.is-desktop > #feed-content-area {
                grid-column: 3 / 4; grid-row: 2 / 3; display: none;
                padding: var(--desktop-content-padding-top) var(--spacing-content-side-padding) var(--desktop-content-padding-bottom) var(--spacing-md);
            }
            #app-container.is-desktop > #overview-content-area,
            #app-container.is-desktop > #contact-content-area {
                grid-column: 1 / 4; grid-row: 2 / 3; display: none;
                padding: var(--desktop-content-padding-top) var(--spacing-content-side-padding) var(--desktop-content-padding-bottom) var(--spacing-content-side-padding);
            }

             #app-container.is-desktop.view-home > #info-content-area { display: block; }
             #app-container.is-desktop.view-home > #dynamic-content-area { display: block; }
             #app-container.is-desktop.view-home > #all-feed-content-area { display: none; }
             #app-container.is-desktop.view-home > #overview-content-area { display: none; }
             #app-container.is-desktop.view-home > #contact-content-area { display: none; }
             #app-container.is-desktop.view-home > #divider-area { display: block; }

             #app-container.is-desktop.view-all-feed > #info-content-area { display: block; }
             #app-container.is-desktop.view-all-feed > #all-feed-content-area { display: block; }
             #app-container.is-desktop.view-all-feed > #dynamic-content-area { display: none; }
             #app-container.is-desktop.view-all-feed > #overview-content-area { display: none; }
             #app-container.is-desktop.view-all-feed > #contact-content-area { display: none; }
             #app-container.is-desktop.view-all-feed > #divider-area { display: block; }
            
             #app-container.is-desktop.view-about > #info-content-area { display: block; }
             #app-container.is-desktop.view-about > #dynamic-content-area { display: block; }
             #app-container.is-desktop.view-about > #all-feed-content-area { display: none; }
             #app-container.is-desktop.view-about > #overview-content-area { display: none; }
             #app-container.is-desktop.view-about > #contact-content-area { display: none; }
             #app-container.is-desktop.view-about > #divider-area { display: block; }

             #app-container.is-desktop.view-overview > #info-content-area { display: none; }
             #app-container.is-desktop.view-overview > #dynamic-content-area { display: none; }
             #app-container.is-desktop.view-overview > #all-feed-content-area { display: none; }
             #app-container.is-desktop.view-overview > #overview-content-area { display: block; }
             #app-container.is-desktop.view-overview > #contact-content-area { display: none; }
             #app-container.is-desktop.view-overview > #divider-area { display: none; }

             #app-container.is-desktop.view-contact > #info-content-area { display: none; }
             #app-container.is-desktop.view-contact > #dynamic-content-area { display: none; }
             #app-container.is-desktop.view-contact > #all-feed-content-area { display: none; }
             #app-container.is-desktop.view-contact > #overview-content-area { display: none; }
             #app-container.is-desktop.view-contact > #contact-content-area { display: block; }
             #app-container.is-desktop.view-contact > #divider-area { display: none; }
        }

        @media (max-width: 768px) { /* MOBILE */
            body {
                height: auto; overflow-y: auto; overflow-x: hidden;
            }
            #app-container.is-mobile {
                display: flex; flex-direction: column; min-height: 100vh;
                height: auto; position: relative; padding-top: var(--mobile-header-height);
            }
            #app-container.is-mobile > #mobile-header-sticky-container {
                display: flex; flex-direction: row; width: 100%;
                position: fixed; top: 0; left: 0; right: 0;
                background-color: var(--color-background); z-index: 1000;
                border-bottom: var(--line-thickness-subtle) solid var(--color-border-subtle);
                box-sizing: border-box; height: var(--mobile-header-height);
            }
            #app-container.is-mobile > #mobile-header-sticky-container > #identity-header-area {
                 flex-grow: 1; flex-shrink: 1;
                 min-width: 50px;
                 display: flex; 
                 flex-direction: column; 
                 justify-content: center;
                 height: 100%;
                 padding: 0 var(--spacing-xs) 0 var(--mobile-content-padding-x);
                 font-size: var(--font-size-mobile-header-responsive);
                 overflow: hidden; 
                 box-sizing: border-box; 
                 align-items: flex-start;
                 cursor: pointer;
            }
            #app-container.is-mobile > #mobile-header-sticky-container > #main-header-area {
                 flex-grow: 0; flex-shrink: 0;
                 display: flex;
                 justify-content: center;
                 align-items: center;
                 height: 100%;
                 padding: 0 var(--spacing-sm);
                 font-size: var(--font-size-mobile-header-responsive);
                 box-sizing: border-box;
            }
            #app-container.is-mobile > #divider-area { display: none; }

            #app-container.is-mobile > #info-content-area,
            #app-container.is-mobile > #feed-content-area,
            #app-container.is-mobile > #overview-content-area,
            #app-container.is-mobile > #dynamic-content-area,
            #app-container.is-mobile > #contact-content-area,
            #app-container.is-mobile > #all-feed-content-area {
                 order: 3; width: 100%; position: static;
                 border: none; max-height: none;
                 padding: var(--spacing-lg) var(--mobile-content-padding-x);
                 display: none; box-sizing: border-box;
            }
            #app-container.is-mobile.view-home > #dynamic-content-area { display: block; }
            #app-container.is-mobile.view-all-feed > #all-feed-content-area { display: block; }
            #app-container.is-mobile.view-info > #info-content-area { display: block; }
            #app-container.is-mobile.view-info > #dynamic-content-area { display: block; }
            #app-container.is-mobile.view-about > #dynamic-content-area { display: block; }
            #app-container.is-mobile.view-overview > #overview-content-area { display: block; }
            #app-container.is-mobile.view-contact > #contact-content-area { display: block; }
        }
    </style>
<body>
    <div id="app-container">
        <div id="mobile-header-sticky-container">
             <div id="identity-header-area"><slot name="identity-header" /></div>
             <div id="main-header-area"><slot name="main-header" /></div>
        </div>
        <div id="divider-area"></div>
        <div id="info-content-area"><slot name="info-content" /></div>
        <div id="feed-content-area"><slot name="feed-content" /></div>
        <div id="overview-content-area"><slot name="overview-content" /></div>
        <div id="dynamic-content-area"><slot name="dynamic-content" /></div>
        <div id="all-feed-content-area"><slot name="all-feed-content" /></div>
        <div id="contact-content-area"><slot name="contact-content" /></div>
    </div>
</body>
</html>